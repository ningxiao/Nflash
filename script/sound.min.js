/** 
 * -------------------------------------------------------------
 * Copyright (c) 2014 baofeng, All rights reserved. 
 * http://www.baofeng.com/ 
 *  
 * @version: 0.1.1 
 * @author: ningxiao <363305175@qq.com> 
 * @description: flash-app 
 * @date: 2015-06-19  17:31:34
 * ------------------------------------------------------------- 
 */ 

var flash={},Stage=null,fps=0,start_time,fpsDate;flash.socket=null,flash.utils={ctx:null,canvas:null,xmlHttp:null,createXMLHttpRequest:function(){window.ActiveXObject?this.xmlHttp=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(this.xmlHttp=new XMLHttpRequest)},createURL:function(url,callback){var type=-1!=url.indexOf(".xml"),data;this.createXMLHttpRequest(),this.xmlHttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&callback&&(data=type?this.responseXML:eval("("+this.responseText+")"),callback(data))},this.xmlHttp.open("GET",url,"true"),this.xmlHttp.send(null)},provide:function(a){for(var b=a.split("."),c=window,d=0,e=b.length;e>d;d++)c=c[b[d]]?c[b[d]]:c[b[d]]=new Object},inherits:function(a,b){a.prototype=new b,a.prototype.constructor=a},require:function(){},loadScript:function(a,b){var c,d=document.getElementsByTagName("head")[0];c=document.createElement("script"),c.type="text/javascript",c.onload=c.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(c.onload=c.onreadystatechange=null,b())},c.src=a,d.appendChild(c)},debug:function(a,b,c){var d,e,f,g,h,i,j;e=function(a){for(var b={},c=[],d=0;d<a.length;d++)b[a[d]]||(b[a[d]]=!0,c.push(a[d]));return c},d=function(a){var b=i[a],c=b[0],e=b[1];if(0!=e.length)for(var f=0,g=e.length;g>f;f++)d(e[f]);j.push(c)},h=function(){flash.utils.loadScript(j[f],function(){f++,g>f?h():c&&c()})},flash.utils.createURL(a,function(a){i=a,j=[],b in i||(j=null),j&&(d(b),j=e(j),g=j.length,f=0),j&&h()})},bind:function(a,b){return a.bind?a.bind(b):function(){a.apply(b,arguments)}},isDemo:function(a){return a.nodeType&&1===a.nodeType?!0:!1},queueImg:function(a,b,c,d){var e,f,g=arguments[4]||0,h=new Image,i=a[g];for(e in i)f=i[e];h.onload=function(){b[e]=h,g++,d.call(this,{total:a.length,loaded:g}),g!=a.length?flash.utils.queueImg.call(this,a,b,c,d,g):c.call(this)},h.src=f},getImageData:function(a,b,c,d,e){return this.ctx||(this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")),this.canvas.setAttribute("width",d),this.canvas.setAttribute("height",e),this.ctx.clearRect(0,0,parseInt(this.canvas.width),parseInt(this.canvas.height)),this.ctx.drawImage(a,b,c,d,e,0,0,d,e),this.ctx.getImageData(0,0,d,e)},setImageData:function(a,b,c){var d=new Image;return this.ctx||(this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")),this.canvas.setAttribute("width",b),this.canvas.setAttribute("height",c),this.ctx.clearRect(0,0,parseInt(this.canvas.width),parseInt(this.canvas.height)),this.ctx.putImageData(a,0,0),d.src=this.canvas.toDataURL(),d},gUid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)}).toUpperCase()},getType:function(a){return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1]},getPoint:function(a){for(var b=a.offsetTop,c=a.offsetLeft;a=a.offsetParent;)b+=a.offsetTop,c+=a.offsetLeft;return{x:c,y:b}},getLength:function(a,b,c,d){var e=c-a,f=d-b;return Math.sqrt(e*e+f*f)},fullScreen:function(a){a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen&&a.webkitRequestFullScreen()},normal:function(a){a.exitFullScreen?a.exitFullScreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitCancelFullScreen&&a.webkitCancelFullScreen()},checkMobile:function(){for(var a=new Array("2.0 MMP","240320","AvantGo","BlackBerry","Blazer","Cellphone","Danger","DoCoMo","Elaine/3.0","EudoraWeb","hiptop","IEMobile","KYOCERA/WX310K","LG/U990","MIDP-2.0","MMEF20","MOT-V","NetFront","Newt","Nintendo Wii","Nitro","Nokia","Opera Mini","Opera Mobi","Palm","Playstation Portable","portalmmm","Proxinet","ProxiNet","SHARP-TQ-GX10","Small","SonyEricsson","Symbian OS","SymbianOS","TS21i-10","UP.Browser","UP.Link","Windows CE","WinWAP","Androi","iPhone","iPod","iPad","Windows Phone","HTC"),b=new Array("Microsoft Pocket Internet Explorer"),c=navigator.userAgent.toString(),d=0;d<a.length;d++)if(c.indexOf(a[d])>=0)return!0;for(var d=(navigator.appName.toString(),0);d<b.length;d++)if(c.indexOf(b[d])>=0)return!0;return!1},bugLog:function(a){flash.socket||console.log(a)},clearAnimate:function(a){Stage&&a in Stage.animate&&(Stage.animate[a]=null,delete Stage.animate[a])},animate:function(a,b,c,d,e){var f={},g=flash.utils.now();"undefined"==typeof c&&(c=400,d="linear"),"string"==typeof c?("function"==typeof d&&(e=d),d=c,c=400):"function"==typeof c?(e=c,c=400,d="linear"):"number"==typeof c&&("function"==typeof d?(e=d,d="linear"):"undefined"==typeof d&&(d="linear"));for(var h in b)f[h]=0,f[h]="opacity"==h?0==Math.round(100*a[h])?0:Math.round(100*a[h])||100:parseInt(a[h])||0;return flash.utils.clearAnimate(a.animateKey),a.animateKey=flash.utils.gUid(),Stage.addAnimate(a.animateKey,function(){var h=flash.utils.now(),i=1-Math.max(0,g-h+c)/c;for(var j in b){var k=flash.Tween[d](i*c,f[j],b[j]-f[j],c);a[j]=k}1==i&&(Stage.stopAnimate(a.animateKey),e&&e.call(a))}),a.animateKey},now:function(){return(new Date).getTime()},create3DContext:function(a,b){var c=["webgl","experimental-webgl","webkit-3d","moz-webgl"],d=null;if(!window.WebGLRenderingContext)return null;for(var e=0;e<c.length;++e){try{d=a.getContext(c[e],b)}catch(f){}if(d)break}return d}},window.requestAnimationFrame||(window.requestAnimationFrame=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(a){setTimeout(a,1e3/60)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||window.clearTimeout),flash.utils.provide("flash.events.Event"),flash.events.Event=function(a){this.target=null,this.type=a},flash.events.COMPLETE="complete",flash.events.ENTER_FRAME="enterFrame",flash.events.ADDED_TO_STAGE="addedToStage",flash.events.ERROR="error",flash.utils.provide("flash.events.SoundEvent"),flash.utils.require("flash.events.Event"),flash.events.SoundEvent=function(){flash.events.Event.apply(this,arguments)},flash.utils.inherits(flash.events.SoundEvent,flash.events.Event),flash.events.SoundEvent.CANPLAY="canplay",flash.events.SoundEvent.ENDED="ended",flash.events.SoundEvent.PAUSE="pause",flash.events.SoundEvent.PLAY="play",flash.events.SoundEvent.TIMEUPDATE="timeupdate",flash.utils.provide("flash.events.MouseEvent"),flash.utils.require("flash.events.Event"),flash.events.MouseEvent=function(){flash.events.Event.apply(this,arguments),this.localX=0,this.localY=0,this.stageX=0,this.stageY=0,this.shiftKey=!0,this.ctrlKey=!0},flash.utils.inherits(flash.events.MouseEvent,flash.events.Event),flash.events.MouseEvent.prototype.setMouseData=function(a){this.stageX=Stage.mouseX,this.stageY=Stage.mouseY,this.localX=this.stageX-a.stageX,this.localY=this.stageY-a.stageY},flash.events.MouseEvent.DBCLICK="dblclick",flash.events.MouseEvent.CLICK="click",flash.events.MouseEvent.MOUSEDOWN="mousedown",flash.events.MouseEvent.MOUSEUP="mouseup",flash.events.MouseEvent.MOUSEMOVE="mousemove",flash.events.MouseEvent.MOUSEOUT="mouseout",flash.events.MouseEvent.MOUSEOVER="mouseover",flash.events.MouseEvent.TOUCHMOVE="touchmove",flash.events.MouseEvent.TOUCHSTART="touchstart",flash.events.MouseEvent.TOUCHEND="touchend",flash.utils.provide("flash.events.EventDispatcher"),flash.utils.require("flash.events.MouseEvent"),flash.events.funList={},flash.events.uint=0,flash.events.EventDispatcher=function(){},flash.events.EventDispatcher.prototype.addEventListener=function(a,b){return flash.events.uint++,flash.events.funList[flash.events.uint]=b,this[a]&&this[a].constructor===Array?this[a].push(flash.events.uint):this[a]=[flash.events.uint],flash.events.uint},flash.events.EventDispatcher.prototype.dispatchEvent=function(a){var b=this[a.type];if(b)for(var c=0,d=b.length;d>c;c++)flash.events.funList[b[c]]&&(a.target=this,a instanceof flash.events.MouseEvent&&a.setMouseData(this),flash.events.funList[b[c]].call(this,a))},flash.events.EventDispatcher.prototype.hasEventListener=function(a){return this[a]?!0:!1},flash.events.EventDispatcher.prototype.removeEventListener=function(a){for(var b in this[a])delete flash.events.funList[b];delete this[a]},flash.events.EventDispatcher.prototype.unlistenByKey=function(a){a in flash.events.funList&&(flash.events.funList[a]=null,delete flash.events.funList[a])},flash.utils.provide("flash.media.Sound"),flash.utils.require("flash.events.Event"),flash.utils.require("flash.events.SoundEvent"),flash.utils.require("flash.events.EventDispatcher"),flash.media.Sound=function(a){flash.events.EventDispatcher.apply(this,arguments),this.bytesLoaded=0,this.loop=!1,this.autoplay=!1,this.url=a||"",this.audio=null,this.url&&this.load(this.url),this.TIMEUPDATE=new flash.events.SoundEvent(flash.events.SoundEvent.TIMEUPDATE),this.CANPLAY=new flash.events.SoundEvent(flash.events.SoundEvent.CANPLAY),this.PAUSE=new flash.events.SoundEvent(flash.events.SoundEvent.PAUSE),this.PLAY=new flash.events.SoundEvent(flash.events.SoundEvent.PLAY),this.ENDED=new flash.events.SoundEvent(flash.events.SoundEvent.ENDED),this.ERROR=new flash.events.Event(flash.events.ERROR)},flash.utils.inherits(flash.media.Sound,flash.events.EventDispatcher),flash.media.Sound.prototype.load=function(a){this.audio||(this.audio=document.createElement("audio")),this.url=a,this.audio.src=a,this.audio.autoplay=this.autoplay,this.audio.loop=this.loop,this.audio.addEventListener(flash.events.SoundEvent.TIMEUPDATE,flash.utils.bind(this.openEvent,this)),this.audio.addEventListener(flash.events.SoundEvent.CANPLAY,flash.utils.bind(this.openEvent,this)),this.audio.addEventListener(flash.events.SoundEvent.PAUSE,flash.utils.bind(this.openEvent,this)),this.audio.addEventListener(flash.events.SoundEvent.PLAY,flash.utils.bind(this.openEvent,this)),this.audio.addEventListener(flash.events.SoundEvent.ENDED,flash.utils.bind(this.openEvent,this)),this.audio.addEventListener(flash.events.ERROR,flash.utils.bind(this.openEvent,this))},flash.media.Sound.prototype.reset=function(){this.loop=!1,this.autoplay=!1,this.url="",this.audio=null},flash.media.Sound.prototype.audiopause=function(){this.audio&&this.audio.pause()},flash.media.Sound.prototype.audioplay=function(){this.audio&&this.audio.play()},flash.media.Sound.prototype.audioreplay=function(){this.audio&&(this.audio.src=this.url,this.audio.play())},flash.media.Sound.prototype.GetDuration=function(){return this.audio?this.audio.duration:0},flash.media.Sound.prototype.GetPaused=function(){return this.audio?this.audio.paused:!0},flash.media.Sound.prototype.GetTime=function(){return this.audio?this.audio.currentTime:0},flash.media.Sound.prototype.SetTime=function(a){this.audio&&(this.audio.currentTime=a)},flash.media.Sound.prototype.openEvent=function(a){switch(a.type){case flash.events.SoundEvent.CANPLAY:this.dispatchEvent(this.CANPLAY);break;case flash.events.SoundEvent.ENDED:this.dispatchEvent(this.ENDED);break;case flash.events.ERROR:this.dispatchEvent(this.ERROR);break;case flash.events.SoundEvent.PAUSE:this.dispatchEvent(this.PAUSE);break;case flash.events.SoundEvent.PLAY:this.dispatchEvent(this.PLAY);break;case flash.events.SoundEvent.TIMEUPDATE:this.dispatchEvent(this.TIMEUPDATE)}},flash.utils.provide("playsound"),flash.utils.require("flash.media.Sound"),flash.utils.require("flash.events.SoundEvent"),playsound.userAgent=navigator.userAgent.toString(),playsound.switch=!0,playsound.soundlist=[],playsound.init=function(){var a="http://192.168.204.61/sound/neointro.ogg",b=new flash.media.Sound,c={win:{start:0,length:215}};b.addEventListener(flash.events.SoundEvent.CANPLAY,function(a){console.log("\u51c6\u5907\u5b8c\u6bd5",a.target.GetDuration())}),b.addEventListener(flash.events.SoundEvent.PLAY,function(a){console.log("\u64ad\u653e",a.target)}),b.addEventListener(flash.events.SoundEvent.PAUSE,function(a){console.log("\u6682\u505c",a.target)}),b.addEventListener(flash.events.SoundEvent.ENDED,function(a){console.log("\u7ed3\u675f",a.target)}),b.addEventListener(flash.events.ERROR,function(a){console.log("\u5f02\u5e38",a.target)}),b.addEventListener(flash.events.SoundEvent.TIMEUPDATE,function(a){var b=a.target;b.GetTime()>=c.win.start+c.win.length&&b.SetTime(0)}),-1!=playsound.userAgent.indexOf("Safari")&&(a=a.replace(/\.ogg/,".mp3")),b.load(a),b.audioplay()},playsound.switchsound=function(){var a,b="http://192.168.204.61/sound/explosion.ogg",c={win:{start:0,length:2}};playsound.soundlist.length?(a=playsound.soundlist.shift(),a.GetPaused()&&(a.SetTime(0),a.audioplay())):(a=new flash.media.Sound,a.addEventListener(flash.events.SoundEvent.CANPLAY,function(a){console.log("\u51c6\u5907\u5b8c\u6bd5",a.target.GetDuration())}),a.addEventListener(flash.events.SoundEvent.PLAY,function(){}),a.addEventListener(flash.events.SoundEvent.PAUSE,function(){}),a.addEventListener(flash.events.SoundEvent.ENDED,function(){}),a.addEventListener(flash.events.ERROR,function(){}),a.addEventListener(flash.events.SoundEvent.TIMEUPDATE,function(a){var b=a.target;b.GetTime()>=c.win.start+c.win.length&&(b.audiopause(),playsound.soundlist.push(b))}),-1!=playsound.userAgent.indexOf("Safari")&&(b=b.replace(/\.ogg/,".mp3")),a.load(b),a.audioplay())},document.addEventListener("touchstart",function(a){playsound.switch?(playsound.switch=!1,playsound.init()):playsound.switchsound(),a.preventDefault()});